# –í—ã–±–æ—Ä —Å–∏—Å—Ç–µ–º—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

## –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

| –ê—Ç—Ä–∏–±—É—Ç | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| –°—Ç–∞—Ç—É—Å | ‚úÖ –ü—Ä–∏–Ω—è—Ç–æ |
| –î–∞—Ç–∞ | 2023-09-04 |
| –ê–≤—Ç–æ—Ä | –ö–æ–º–∞–Ω–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ |
| –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ | 2024-01-05 |

## –ö–æ–Ω—Ç–µ–∫—Å—Ç

–î–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫—Ä–∞—É–¥—Ñ–∞–Ω–¥–∏–Ω–≥–æ–≤–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

### –ö–ª—é—á–µ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ö–æ–¥ | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|-----|------------|------------------|
| –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å | SCA01 | –†–æ—Å—Ç –¥–∞–Ω–Ω—ã—Ö | 1 000 000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å | SCA03 | –ü–∏–∫–æ–≤–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ | 10 000 —Ç—Ä./—á–∞—Å |
| –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å | AVA01 | –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã | 99.9% |
| –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å | DUR02 | –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ | < 1 —á–∞—Å |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | PER01 | –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ | ‚â§ 2 —Å–µ–∫—É–Ω–¥ |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | SEC01 | –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ | AES-256 |
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | SEC02 | –ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö | GDPR, LGPD |
| –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ | DUR03 | –ì–µ–æ-—Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è | Multi-region |

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

```mermaid
graph TD
    A[API Gateway] --> B[Services]
    B --> C[PostgreSQL Primary]
    C --> D[PostgreSQL Replica 1]
    C --> E[PostgreSQL Replica 2]
    B --> F[Redis Cache]
    G[Backup Service] --> C
    G --> H[(S3 Backup)]
    I[Monitoring] --> C
    I --> F
```

## –†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã

### 1. PostgreSQL üéØ

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- üëç –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
- üëç ACID —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- üëç JSON –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- üëç –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å
- üëç –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –∏–∑ –∫–æ—Ä–æ–±–∫–∏

#### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- üëé –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- üëé –°–ª–æ–∂–Ω–æ—Å—Ç—å —à–∞—Ä–¥–∏–Ω–≥–∞
- üëé –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ—Å—É—Ä—Å–∞–º

### 2. MongoDB üìÑ

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- üëç –ì–∏–±–∫–∞—è —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö
- üëç –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- üëç –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- üëç –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- üëé –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ ACID
- üëé –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- üëé –ë–æ–ª—å—à–µ –º–µ—Å—Ç–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
- üëé –†–∏—Å–∫ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö

### 3. Cassandra ‚ö°

#### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- üëç –õ–∏–Ω–µ–π–Ω–∞—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- üëç Multi-DC —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è
- üëç –í—ã—Å–æ–∫–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
- üëç –û—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

#### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
- üëé Eventual consistency
- üëé –°–ª–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤
- üëé –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- üëé –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏

## –†–µ—à–µ–Ω–∏–µ

> –í—ã–±—Ä–∞–Ω PostgreSQL –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

```mermaid
graph TB
    A[Application] --> B[Connection Pool]
    B --> C[Primary DB]
    C --> D[Read Replica 1]
    C --> E[Read Replica 2]
    A --> F[Redis Cache]
    G[Monitoring] --> H[Prometheus]
    H --> I[Grafana]
    J[Backup] --> K[WAL-G]
    K --> L[S3]
```

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

1. üíæ –û—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
   - PostgreSQL 15+
   - –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è
   - Point-in-time recovery

2. üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
   - Connection pooling
   - Query optimization
   - –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

3. üîÑ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
   - Redis cluster
   - Cache invalidation
   - Session storage

4. üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
   - DB metrics
   - Query performance
   - Cache hit ratio

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

1. üõ†Ô∏è –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
   - PostgreSQL 15
   - Redis 7
   - PgBouncer
   - WAL-G

2. ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
   - Max connections: 1000
   - Shared buffers: 25% RAM
   - WAL level: logical
   - Archive mode: on

## –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è

### –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ üëç
- –ù–∞–¥–µ–∂–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ACID –≥–∞—Ä–∞–Ω—Ç–∏–∏
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ –±—ç–∫–∞–ø–æ–≤
- JSON –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- –ë–æ–≥–∞—Ç–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞

### –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ üëé
- –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- –°–ª–æ–∂–Ω–æ—Å—Ç—å —à–∞—Ä–¥–∏–Ω–≥–∞
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ—Å—É—Ä—Å–∞–º
- –°—Ç–æ–∏–º–æ—Å—Ç—å –ª–∏—Ü–µ–Ω–∑–∏–π

## –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### –§–∞–∑–∞ 1: –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (1 –º–µ—Å—è—Ü)
1. üéØ Primary DB
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL
   - –ë–∞–∑–æ–≤–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

2. üîÑ –†–µ–ø–ª–∏–∫–∞—Ü–∏—è
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–ø–ª–∏–∫
   - Failover —Ç–µ—Å—Ç—ã
   - –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏

### –§–∞–∑–∞ 2: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (2 –º–µ—Å—è—Ü–∞)
1. üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
   - Query optimization
   - –ò–Ω–¥–µ–∫—Å—ã
   - –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

2. üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
   - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
   - –ê—É–¥–∏—Ç
   - –ë—ç–∫–∞–ø—ã

## –°–≤—è–∑–∞–Ω–Ω—ã–µ ADR
- [2023-09.1 - –í—ã–±–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–π —Ñ–æ—Ä–º—ã —Å–∏—Å—Ç–µ–º—ã](./2023-09.1%20-%20–í—ã–±–æ—Ä%20–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–π%20—Ñ–æ—Ä–º—ã%20—Å–∏—Å—Ç–µ–º—ã.md)
- [2024-01.3 - –í—ã–±–æ—Ä —Å–æ–±—ã—Ç–∏–π–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](./2024-01.3%20-%20–í—ã–±–æ—Ä%20—Å–æ–±—ã—Ç–∏–π–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π%20–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.md)
- [2024-01.4 - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–∏—Å–∫–∞ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π](./2024-01.4%20-%20–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞%20–ø–æ–∏—Å–∫–∞%20–∏%20—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.md)
